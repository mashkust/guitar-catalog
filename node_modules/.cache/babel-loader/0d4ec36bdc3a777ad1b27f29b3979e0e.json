{"ast":null,"code":"var _jsxFileName = \"/Users/mashkust/react-starter-pack-main/src/components/basket-page.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport PageHeader from './page-header';\nimport PageFooter from './page-footer';\nimport { AppRoute, VALIDATION_COUPON } from '../const';\nimport { Link } from 'react-router-dom';\nimport BasketCard from './basket-card';\nimport { useAppDispatch, useAppSelector } from '../hooks/hooks';\nimport { postCouponAction, postOrdersAction } from '../store/api-actions';\nimport { setIsBasketRemoval, setIsCoupon, setIsDisconnect } from '../store/guitar-data';\nimport BasketRemoval from './basket-removal';\nimport { startScroll } from '../utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { createElement as _createElement } from \"react\";\n\nfunction BasketPage() {\n  _s();\n\n  const boughtGuitars = useAppSelector(_ref => {\n    let {\n      DATA\n    } = _ref;\n    return DATA.boughtGuitars;\n  });\n  const isGuitar = useAppSelector(_ref2 => {\n    let {\n      DATA\n    } = _ref2;\n    return DATA.isGuitar;\n  });\n  const isBasketRemoval = useAppSelector(_ref3 => {\n    let {\n      DATA\n    } = _ref3;\n    return DATA.isBasketRemoval;\n  });\n  const isDiscount = useAppSelector(_ref4 => {\n    let {\n      DATA\n    } = _ref4;\n    return DATA.isDiscount;\n  });\n  const isCoupon = useAppSelector(_ref5 => {\n    let {\n      DATA\n    } = _ref5;\n    return DATA.isCoupon;\n  });\n  const dispatch = useAppDispatch();\n  const [coupon, setCoupon] = useState('');\n  const [isValidationCoupon, setIsValidationCoupon] = useState(false);\n\n  document.onkeydown = function (evt) {\n    evt = evt || window.event;\n    let isEscape = false;\n\n    if ('key' in evt) {\n      isEscape = evt.key === 'Escape' || evt.key === 'Esc';\n    }\n\n    if (isEscape) {\n      dispatch(setIsBasketRemoval(false));\n      startScroll();\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(PageHeader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"page-content \",\n      children: [isGuitar ? isBasketRemoval && /*#__PURE__*/_jsxDEV(BasketRemoval, {\n        guitar: isGuitar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 40\n      }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"page-content__title title title--bigger\",\n          children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"breadcrumbs page-content__breadcrumbs page-content__breadcrumbs--on-cart-page\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"breadcrumbs__item\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              className: \"link\",\n              to: AppRoute.Page1,\n              children: \"\\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 45,\n              columnNumber: 47\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"breadcrumbs__item\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              className: \"link\",\n              to: AppRoute.Page1,\n              children: \"\\u041A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 47,\n              columnNumber: 47\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 47,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"breadcrumbs__item\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"link\",\n              children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 49,\n              columnNumber: 47\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart\",\n          children: [boughtGuitars.length !== 0 ? boughtGuitars.map(guitar => /*#__PURE__*/_createElement(BasketCard, {\n            guitar,\n            key: guitar.id,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 54,\n              columnNumber: 15\n            }\n          })) : 'Корзина пуста', /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart__footer\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cart__coupon coupon\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"title title--little coupon__title\",\n                children: \"\\u041F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434 \\u043D\\u0430 \\u0441\\u043A\\u0438\\u0434\\u043A\\u0443\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 57,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"coupon__info\",\n                children: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0432\\u043E\\u0439 \\u043F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434, \\u0435\\u0441\\u043B\\u0438 \\u043E\\u043D \\u0443 \\u0432\\u0430\\u0441 \\u0435\\u0441\\u0442\\u044C.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 58,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                className: \"coupon__form\",\n                id: \"coupon-form\",\n                onSubmit: evt => {\n                  evt.preventDefault();\n\n                  if (VALIDATION_COUPON.includes(coupon.toLowerCase())) {\n                    dispatch(setIsCoupon(coupon.toLowerCase()));\n                    dispatch(setIsDisconnect(navigator.onLine));\n                    dispatch(postCouponAction({\n                      coupon: coupon.toLowerCase()\n                    }));\n                  } else {\n                    dispatch(setIsCoupon(null));\n                  }\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-input coupon__input\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"visually-hidden\",\n                    children: \"\\u041F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 74,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434\",\n                    id: \"coupon\",\n                    name: \"coupon\",\n                    value: coupon,\n                    onChange: evt => {\n                      if (evt.currentTarget.value.includes(' ')) {\n                        setCoupon(evt.currentTarget.value.split(' ').join(''));\n                      } else {\n                        setCoupon(evt.currentTarget.value);\n                      }\n\n                      setIsValidationCoupon(false);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 75,\n                    columnNumber: 21\n                  }, this), isValidationCoupon && isCoupon !== null ? /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"form-input__message form-input__message--success\",\n                    children: \" \\u041F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434 \\u043F\\u0440\\u0438\\u043D\\u044F\\u0442\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 86,\n                    columnNumber: 64\n                  }, this) : '', isValidationCoupon && isCoupon === null ? /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"form-input__message form-input__message--error\",\n                    children: \" \\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u043F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 87,\n                    columnNumber: 64\n                  }, this) : '']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 73,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"button button--big coupon__button\",\n                  onClick: () => {\n                    if (coupon !== '') {\n                      setIsValidationCoupon(true);\n                    }\n                  },\n                  children: \"\\u041F\\u0440\\u0438\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 89,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 59,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 56,\n              columnNumber: 15\n            }, this), console.log(isDiscount), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cart__total-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"cart__total-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value-name\",\n                  children: \"\\u0412\\u0441\\u0435\\u0433\\u043E:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 101,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value\",\n                  children: [boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      return sum + elem.price * elem.quantity;\n                    } else {\n                      return sum + elem.price;\n                    }\n                  }, 0), \" \\u20BD\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 102,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"cart__total-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value-name\",\n                  children: \"\\u0421\\u043A\\u0438\\u0434\\u043A\\u0430:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 108,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: isDiscount !== 0 ? 'cart__total-value cart__total-value--bonus' : 'cart__total-value ',\n                  children: [\" \", 0.01 * isDiscount * boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      return sum + elem.price * elem.quantity;\n                    } else {\n                      return sum + elem.price;\n                    }\n                  }, 0), \" \\u20BD\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 109,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"cart__total-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value-name\",\n                  children: \"\\u041A \\u043E\\u043F\\u043B\\u0430\\u0442\\u0435:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 117,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value cart__total-value--payment\",\n                  children: [(1 - 0.01 * isDiscount) * boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      return sum + elem.price * elem.quantity;\n                    } else {\n                      return sum + elem.price;\n                    }\n                  }, 0), \" \\u20BD\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 118,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"button button--red button--big cart__order-button\",\n                onClick: () => {\n                  dispatch(postOrdersAction({\n                    guitarsIds: boughtGuitars.map(guitar => guitar.id),\n                    coupon: isCoupon\n                  }));\n                  dispatch(setIsDisconnect(navigator.onLine));\n                },\n                disabled: boughtGuitars.length === 0,\n                children: \"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PageFooter, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, this);\n}\n\n_s(BasketPage, \"yA1r1kX32PFnP+ddQPMjLN70qJ8=\", false, function () {\n  return [useAppSelector, useAppSelector, useAppSelector, useAppSelector, useAppSelector, useAppDispatch];\n});\n\n_c = BasketPage;\nexport default BasketPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"BasketPage\");","map":{"version":3,"sources":["/Users/mashkust/react-starter-pack-main/src/components/basket-page.tsx"],"names":["React","useState","PageHeader","PageFooter","AppRoute","VALIDATION_COUPON","Link","BasketCard","useAppDispatch","useAppSelector","postCouponAction","postOrdersAction","setIsBasketRemoval","setIsCoupon","setIsDisconnect","BasketRemoval","startScroll","BasketPage","boughtGuitars","DATA","isGuitar","isBasketRemoval","isDiscount","isCoupon","dispatch","coupon","setCoupon","isValidationCoupon","setIsValidationCoupon","document","onkeydown","evt","window","event","isEscape","key","Page1","length","map","guitar","id","preventDefault","includes","toLowerCase","navigator","onLine","currentTarget","value","split","join","console","log","reduce","sum","elem","quantity","price","guitarsIds"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PageHeader from './page-header';\nimport PageFooter from './page-footer';\nimport { AppRoute, VALIDATION_COUPON } from '../const';\nimport { Link } from 'react-router-dom';\nimport BasketCard from './basket-card';\nimport { useAppDispatch, useAppSelector } from '../hooks/hooks';\nimport { Guitar } from '../types/types';\nimport { postCouponAction, postOrdersAction } from '../store/api-actions';\nimport { setIsBasketRemoval, setIsCoupon, setIsDisconnect } from '../store/guitar-data';\nimport BasketRemoval from './basket-removal';\nimport { CouponTypes } from '../types/types';\nimport { startScroll } from '../utils';\n\nfunction BasketPage(): JSX.Element {\n  const boughtGuitars = useAppSelector(({ DATA }) => DATA.boughtGuitars);\n  const isGuitar = useAppSelector(({ DATA }) => DATA.isGuitar);\n  const isBasketRemoval = useAppSelector(({ DATA }) => DATA.isBasketRemoval);\n  const isDiscount = useAppSelector(({ DATA }) => DATA.isDiscount);\n  const isCoupon = useAppSelector(({ DATA }) => DATA.isCoupon);\n  const dispatch = useAppDispatch();\n  const [coupon, setCoupon] = useState<string>('');\n  const [isValidationCoupon, setIsValidationCoupon] = useState<boolean>(false);\n\n  document.onkeydown = function (evt) {\n    evt = evt || window.event;\n    let isEscape = false;\n    if ('key' in evt) {\n      isEscape = (evt.key === 'Escape' || evt.key === 'Esc');\n    }\n    if (isEscape) {\n      dispatch(setIsBasketRemoval(false));\n      startScroll();\n    }\n  };\n\n  return (\n    <React.Fragment>\n      <PageHeader />\n      <main className=\"page-content \">\n        {isGuitar ? isBasketRemoval && <BasketRemoval guitar={isGuitar} /> : ''}\n        <div className=\"container\">\n          <h1 className=\"page-content__title title title--bigger\" >Корзина</h1>\n          <ul className=\"breadcrumbs page-content__breadcrumbs page-content__breadcrumbs--on-cart-page\">\n            <li className=\"breadcrumbs__item\"><Link className=\"link\" to={AppRoute.Page1}>Главная</Link>\n            </li>\n            <li className=\"breadcrumbs__item\"><Link className=\"link\" to={AppRoute.Page1}>Каталог</Link>\n            </li>\n            <li className=\"breadcrumbs__item\"><a className=\"link\">Корзина</a>\n            </li>\n          </ul>\n          <div className=\"cart\">\n            {boughtGuitars.length !== 0 ? boughtGuitars.map((guitar: Guitar) => (\n              <BasketCard {...{ guitar }} key={guitar.id} />)) : 'Корзина пуста'}\n            <div className=\"cart__footer\">\n              <div className=\"cart__coupon coupon\">\n                <h2 className=\"title title--little coupon__title\">Промокод на скидку</h2>\n                <p className=\"coupon__info\">Введите свой промокод, если он у вас есть.</p>\n                <form className=\"coupon__form\" id=\"coupon-form\"\n                  onSubmit={(evt: React.FormEvent<HTMLFormElement>) => {\n                    evt.preventDefault();\n                    if ( VALIDATION_COUPON.includes(coupon.toLowerCase() as CouponTypes)\n                    ) {\n                      dispatch(setIsCoupon(coupon.toLowerCase() as CouponTypes));\n                      dispatch((setIsDisconnect(navigator.onLine)));\n                      dispatch(postCouponAction({\n                        coupon: coupon.toLowerCase() as CouponTypes,\n                      }));\n                    }\n                    else {dispatch(setIsCoupon(null));}\n                  }}\n                >\n                  <div className=\"form-input coupon__input\">\n                    <label className=\"visually-hidden\">Промокод</label>\n                    <input type=\"text\" placeholder=\"Введите промокод\" id=\"coupon\" name=\"coupon\" value={coupon}\n                      onChange={(evt: React.ChangeEvent<HTMLInputElement>) => {\n                        if (evt.currentTarget.value.includes(' ')) {\n                          setCoupon(evt.currentTarget.value.split(' ').join(''));\n                        }\n                        else {\n                          setCoupon(evt.currentTarget.value);\n                        }\n                        setIsValidationCoupon(false);\n                      }}\n                    />\n                    {isValidationCoupon && isCoupon !== null ? <p className=\"form-input__message form-input__message--success\"> Промокод принят</p> : ''}\n                    {isValidationCoupon && isCoupon === null ? <p className=\"form-input__message form-input__message--error\"> Неверный промокод</p> : ''}\n                  </div>\n                  <button className=\"button button--big coupon__button\"\n                    onClick={() => {\n                      if (coupon !== '') {\n                        setIsValidationCoupon(true);\n                      }\n                    }}\n                  >Применить\n                  </button>\n                </form>\n              </div>\n              {console.log(isDiscount)}\n              <div className=\"cart__total-info\">\n                <p className=\"cart__total-item\"><span className=\"cart__total-value-name\">Всего:</span>\n                  <span className=\"cart__total-value\">{boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) { return sum + elem.price * elem.quantity; }\n                    else { return sum + elem.price; }\n                  }, 0)} ₽\n                  </span>\n                </p>\n                <p className=\"cart__total-item\"><span className=\"cart__total-value-name\">Скидка:</span>\n                  <span className= {isDiscount !== 0 ? 'cart__total-value cart__total-value--bonus' : 'cart__total-value '}> {0.01 * isDiscount * boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      return sum + elem.price * elem.quantity ;\n                    }\n                    else { return sum + elem.price; }\n                  }, 0)} ₽\n                  </span>\n                </p>\n                <p className=\"cart__total-item\"><span className=\"cart__total-value-name\">К оплате:</span>\n                  <span className=\"cart__total-value cart__total-value--payment\">{(1- 0.01 * isDiscount) * boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) { return sum + elem.price * elem.quantity ; }\n                    else { return sum + elem.price; }\n                  }, 0)} ₽\n                  </span>\n                </p>\n                <button className=\"button button--red button--big cart__order-button\"\n                  onClick={() => {\n                    dispatch(postOrdersAction({\n                      guitarsIds: boughtGuitars.map((guitar: Guitar) => guitar.id),\n                      coupon: isCoupon,\n                    }));\n                    dispatch((setIsDisconnect(navigator.onLine)));\n                  }}\n                  disabled = {boughtGuitars.length === 0}\n                >Оформить заказ\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n      <PageFooter />\n    </React.Fragment>\n  );\n}\n\nexport default BasketPage;\n"]},"metadata":{},"sourceType":"module"}