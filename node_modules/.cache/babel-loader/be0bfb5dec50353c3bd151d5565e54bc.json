{"ast":null,"code":"var _jsxFileName = \"/Users/mashkust/react-starter-pack-main/src/components/basket-page.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport PageHeader from './page-header';\nimport PageFooter from './page-footer';\nimport { AppRoute, VALIDATION_COUPON } from '../const';\nimport { Link } from 'react-router-dom';\nimport BasketCard from './basket-card';\nimport { useAppDispatch, useAppSelector } from '../hooks/hooks';\nimport { postCouponAction, postOrdersAction } from '../store/api-actions';\nimport { setIsCoupon, setIsDisconnect } from '../store/guitar-data';\nimport BasketRemoval from './basket-removal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { createElement as _createElement } from \"react\";\n\nfunction BasketPage() {\n  _s();\n\n  const boughtGuitars = useAppSelector(_ref => {\n    let {\n      DATA\n    } = _ref;\n    return DATA.boughtGuitars;\n  });\n  const isGuitar = useAppSelector(_ref2 => {\n    let {\n      DATA\n    } = _ref2;\n    return DATA.isGuitar;\n  });\n  const isBasketRemoval = useAppSelector(_ref3 => {\n    let {\n      DATA\n    } = _ref3;\n    return DATA.isBasketRemoval;\n  });\n  const isDiscount = useAppSelector(_ref4 => {\n    let {\n      DATA\n    } = _ref4;\n    return DATA.isDiscount;\n  });\n  const isCoupon = useAppSelector(_ref5 => {\n    let {\n      DATA\n    } = _ref5;\n    return DATA.isCoupon;\n  });\n  const dispatch = useAppDispatch();\n  const [coupon, setCoupon] = useState('');\n  const [isValidationCoupon, setIsValidationCoupon] = useState(false); // const oldBoughtGuitars = localStorage.getItem('BoughtGuitars');\n  // dispatch(buyGuitar(oldBoughtGuitars.))\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(PageHeader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"page-content \",\n      children: [isGuitar ? isBasketRemoval && /*#__PURE__*/_jsxDEV(BasketRemoval, {\n        guitar: isGuitar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 40\n      }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"page-content__title title title--bigger\",\n          children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 33,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"breadcrumbs page-content__breadcrumbs page-content__breadcrumbs--on-cart-page\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"breadcrumbs__item\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              className: \"link\",\n              to: AppRoute.Page1,\n              children: \"\\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 35,\n              columnNumber: 47\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 35,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"breadcrumbs__item\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              className: \"link\",\n              to: AppRoute.Page1,\n              children: \"\\u041A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 37,\n              columnNumber: 47\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 37,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"breadcrumbs__item\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"link\",\n              children: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 39,\n              columnNumber: 47\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 39,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart\",\n          children: [boughtGuitars.length !== 0 ? boughtGuitars.map(guitar => /*#__PURE__*/_createElement(BasketCard, {\n            guitar,\n            key: guitar.id,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 44,\n              columnNumber: 15\n            }\n          })) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart__footer\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cart__coupon coupon\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"title title--little coupon__title\",\n                children: \"\\u041F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434 \\u043D\\u0430 \\u0441\\u043A\\u0438\\u0434\\u043A\\u0443\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 47,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"coupon__info\",\n                children: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0432\\u043E\\u0439 \\u043F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434, \\u0435\\u0441\\u043B\\u0438 \\u043E\\u043D \\u0443 \\u0432\\u0430\\u0441 \\u0435\\u0441\\u0442\\u044C.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 48,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                className: \"coupon__form\",\n                id: \"coupon-form\",\n                onSubmit: evt => {\n                  evt.preventDefault();\n\n                  if (VALIDATION_COUPON.includes(coupon.toLowerCase())) {\n                    dispatch(setIsCoupon(VALIDATION_COUPON.includes(coupon.toLowerCase())));\n                    dispatch(setIsDisconnect(navigator.onLine));\n                    dispatch(postCouponAction({\n                      coupon: coupon.toLowerCase()\n                    }));\n                  } else {\n                    dispatch(setIsCoupon(null));\n                  }\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-input coupon__input\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"visually-hidden\",\n                    children: \"\\u041F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 64,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434\",\n                    id: \"coupon\",\n                    name: \"coupon\",\n                    value: coupon,\n                    onChange: evt => {\n                      if (evt.currentTarget.value.includes(' ')) {\n                        setCoupon(evt.currentTarget.value.split(' ').join(''));\n                      } else {\n                        setCoupon(evt.currentTarget.value);\n                      }\n\n                      setIsValidationCoupon(false);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 65,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: isValidationCoupon && isCoupon !== null ? 'form-input__message form-input__message--success' : 'form-input__message form-input__message--error',\n                    children: [\" \", isValidationCoupon ? 'Промокод принят' : 'Неверный промокод']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 77,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 63,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"button button--big coupon__button\",\n                  onClick: () => {\n                    setIsValidationCoupon(true);\n                  },\n                  children: \"\\u041F\\u0440\\u0438\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 79,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 49,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 46,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cart__total-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"cart__total-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value-name\",\n                  children: \"\\u0412\\u0441\\u0435\\u0433\\u043E:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 88,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value\",\n                  children: [boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      return sum + elem.price * elem.quantity;\n                    } else {\n                      return sum + elem.price;\n                    }\n                  }, 0), \" \\u20BD\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 89,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"cart__total-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value-name\",\n                  children: \"\\u0421\\u043A\\u0438\\u0434\\u043A\\u0430:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 95,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: isDiscount !== 0 ? 'cart__total-value cart__total-value--bonus' : 'cart__total-value ',\n                  children: [\" \", boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      const summ = sum + elem.price * elem.quantity;\n                      return summ;\n                    } else {\n                      return sum + elem.price;\n                    }\n                  }, 0), \" \\u20BD\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 96,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"cart__total-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value-name\",\n                  children: \"\\u041A \\u043E\\u043F\\u043B\\u0430\\u0442\\u0435:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 104,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"cart__total-value cart__total-value--payment\",\n                  children: [boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      return (sum + elem.price * elem.quantity) * (1 - 0.01 * isDiscount);\n                    } else {\n                      return sum + elem.price;\n                    }\n                  }, 0), \" \\u20BD\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 105,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"button button--red button--big cart__order-button\",\n                onClick: () => {\n                  dispatch(postOrdersAction({\n                    guitarsIds: boughtGuitars.map(guitar => guitar.id),\n                    coupon: isCoupon\n                  }));\n                  dispatch(setIsDisconnect(navigator.onLine));\n                },\n                children: \"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PageFooter, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 28,\n    columnNumber: 5\n  }, this);\n}\n\n_s(BasketPage, \"yA1r1kX32PFnP+ddQPMjLN70qJ8=\", false, function () {\n  return [useAppSelector, useAppSelector, useAppSelector, useAppSelector, useAppSelector, useAppDispatch];\n});\n\n_c = BasketPage;\nexport default BasketPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"BasketPage\");","map":{"version":3,"sources":["/Users/mashkust/react-starter-pack-main/src/components/basket-page.tsx"],"names":["React","useState","PageHeader","PageFooter","AppRoute","VALIDATION_COUPON","Link","BasketCard","useAppDispatch","useAppSelector","postCouponAction","postOrdersAction","setIsCoupon","setIsDisconnect","BasketRemoval","BasketPage","boughtGuitars","DATA","isGuitar","isBasketRemoval","isDiscount","isCoupon","dispatch","coupon","setCoupon","isValidationCoupon","setIsValidationCoupon","Page1","length","map","guitar","id","evt","preventDefault","includes","toLowerCase","navigator","onLine","currentTarget","value","split","join","reduce","sum","elem","quantity","price","summ","guitarsIds"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PageHeader from './page-header';\nimport PageFooter from './page-footer';\nimport { AppRoute, VALIDATION_COUPON } from '../const';\nimport { Link } from 'react-router-dom';\nimport BasketCard from './basket-card';\nimport { useAppDispatch, useAppSelector } from '../hooks/hooks';\nimport { Guitar } from '../types/types';\nimport { postCouponAction, postOrdersAction } from '../store/api-actions';\nimport { setIsCoupon, setIsDisconnect } from '../store/guitar-data';\nimport BasketRemoval from './basket-removal';\nimport { CouponTypes } from '../types/types';\n\nfunction BasketPage(): JSX.Element {\n  const boughtGuitars = useAppSelector(({ DATA }) => DATA.boughtGuitars);\n  const isGuitar = useAppSelector(({ DATA }) => DATA.isGuitar);\n  const isBasketRemoval = useAppSelector(({ DATA }) => DATA.isBasketRemoval);\n  const isDiscount = useAppSelector(({ DATA }) => DATA.isDiscount);\n  const isCoupon = useAppSelector(({ DATA }) => DATA.isCoupon);\n  const dispatch = useAppDispatch();\n\n  const [coupon, setCoupon] = useState<string>('');\n  const [isValidationCoupon, setIsValidationCoupon] = useState<boolean>(false);\n\n  // const oldBoughtGuitars = localStorage.getItem('BoughtGuitars');\n  // dispatch(buyGuitar(oldBoughtGuitars.))\n  return (\n    <React.Fragment>\n      <PageHeader />\n      <main className=\"page-content \">\n        {isGuitar ? isBasketRemoval && <BasketRemoval guitar={isGuitar} /> : ''}\n        <div className=\"container\">\n          <h1 className=\"page-content__title title title--bigger\" >Корзина</h1>\n          <ul className=\"breadcrumbs page-content__breadcrumbs page-content__breadcrumbs--on-cart-page\">\n            <li className=\"breadcrumbs__item\"><Link className=\"link\" to={AppRoute.Page1}>Главная</Link>\n            </li>\n            <li className=\"breadcrumbs__item\"><Link className=\"link\" to={AppRoute.Page1}>Каталог</Link>\n            </li>\n            <li className=\"breadcrumbs__item\"><a className=\"link\">Корзина</a>\n            </li>\n          </ul>\n          <div className=\"cart\">\n            {boughtGuitars.length !== 0 ? boughtGuitars.map((guitar: Guitar) => (\n              <BasketCard {...{ guitar }} key={guitar.id} />)) : ''}\n            <div className=\"cart__footer\">\n              <div className=\"cart__coupon coupon\">\n                <h2 className=\"title title--little coupon__title\">Промокод на скидку</h2>\n                <p className=\"coupon__info\">Введите свой промокод, если он у вас есть.</p>\n                <form className=\"coupon__form\" id=\"coupon-form\"\n                  onSubmit={(evt: React.FormEvent<HTMLFormElement>) => {\n                    evt.preventDefault();\n                    if ( VALIDATION_COUPON.includes(coupon.toLowerCase() as CouponTypes)\n                    ) {\n                      dispatch(setIsCoupon(VALIDATION_COUPON.includes(coupon.toLowerCase() as CouponTypes)));\n                      dispatch((setIsDisconnect(navigator.onLine)));\n                      dispatch(postCouponAction({\n                        coupon: coupon.toLowerCase() as CouponTypes,\n                      }));\n                    }\n                    else {dispatch(setIsCoupon(null));}\n                  }}\n                >\n                  <div className=\"form-input coupon__input\">\n                    <label className=\"visually-hidden\">Промокод</label>\n                    <input type=\"text\" placeholder=\"Введите промокод\" id=\"coupon\" name=\"coupon\" value={coupon}\n                      onChange={(evt: React.ChangeEvent<HTMLInputElement>) => {\n                        if (evt.currentTarget.value.includes(' ')) {\n                          setCoupon(evt.currentTarget.value.split(' ').join(''));\n\n                        }\n                        else {\n                          setCoupon(evt.currentTarget.value);\n                        }\n                        setIsValidationCoupon(false);\n                      }}\n                    />\n                    <p className={isValidationCoupon && isCoupon !== null ? 'form-input__message form-input__message--success' : 'form-input__message form-input__message--error'} > {isValidationCoupon ? 'Промокод принят' : 'Неверный промокод'}</p>\n                  </div>\n                  <button className=\"button button--big coupon__button\"\n                    onClick={() => {\n                      setIsValidationCoupon(true);\n                    }}\n                  >Применить\n                  </button>\n                </form>\n              </div>\n              <div className=\"cart__total-info\">\n                <p className=\"cart__total-item\"><span className=\"cart__total-value-name\">Всего:</span>\n                  <span className=\"cart__total-value\">{boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) { return sum + elem.price * elem.quantity; }\n                    else { return sum + elem.price; }\n                  }, 0)} ₽\n                  </span>\n                </p>\n                <p className=\"cart__total-item\"><span className=\"cart__total-value-name\">Скидка:</span>\n                  <span className= {isDiscount !== 0 ? 'cart__total-value cart__total-value--bonus' : 'cart__total-value '}> {boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) {\n                      const summ = (sum + elem.price * elem.quantity) ;\n                      return summ;}\n                    else { return sum + elem.price; }\n                  }, 0)} ₽\n                  </span>\n                </p>\n                <p className=\"cart__total-item\"><span className=\"cart__total-value-name\">К оплате:</span>\n                  <span className=\"cart__total-value cart__total-value--payment\">{boughtGuitars.reduce((sum, elem) => {\n                    if (elem.quantity) { return ((sum + elem.price * elem.quantity) * (1- 0.01 * isDiscount)); }\n                    else { return (sum + elem.price); }\n                  }, 0)} ₽\n                  </span>\n                </p>\n                <button className=\"button button--red button--big cart__order-button\"\n                  onClick={() => {\n                    dispatch(postOrdersAction({\n                      guitarsIds: boughtGuitars.map((guitar: Guitar) => guitar.id),\n                      coupon: isCoupon,\n                    }));\n                    dispatch((setIsDisconnect(navigator.onLine)));\n                  }}\n                >Оформить заказ\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n      <PageFooter />\n    </React.Fragment>\n  );\n}\n\nexport default BasketPage;\n"]},"metadata":{},"sourceType":"module"}