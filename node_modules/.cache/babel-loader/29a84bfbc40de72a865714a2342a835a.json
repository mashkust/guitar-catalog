{"ast":null,"code":"import _toConsumableArray from\"/Users/mashkust/react-starter-pack-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/mashkust/react-starter-pack-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from'react';import{useState}from'react';import{generatePath,Link,useNavigate}from'react-router-dom';import{AppRoute,STARS_MAX}from'../const';import{useAppDispatch,useAppSelector}from'../hooks/hooks';import{fetchCommentsAction}from'../store/api-actions';import{setIsBasket,setIsGuitar}from'../store/guitar-data';import{pasrePrice,stopScroll}from'../utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function GuitarCard(_ref){var guitar=_ref.guitar;var name=guitar.name,price=guitar.price,previewImg=guitar.previewImg,id=guitar.id,rating=guitar.rating;var boughtGuitars=useAppSelector(function(_ref2){var DATA=_ref2.DATA;return DATA.boughtGuitars;});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),mount=_useState2[0],setMount=_useState2[1];var STARS=Math.ceil(rating);var NULL_STARS=STARS_MAX-STARS;var dispatch=useAppDispatch();var navigate=useNavigate();if(!mount){if(id){dispatch(fetchCommentsAction(id));}}useEffect(function(){setMount(true);},[]);var onBookingBtnClick=function onBookingBtnClick(){dispatch(setIsBasket(true));dispatch(setIsGuitar(guitar));};return/*#__PURE__*/_jsxs(\"div\",{className:\"product-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"img/content/\".concat(previewImg.length&&previewImg.slice(0).substring(4)),srcSet:\"img/content/\".concat(previewImg.length&&previewImg.slice(0).substring(4,previewImg.length-4),\"@2x.jpg 2x\"),width:\"75\",height:\"190\",alt:name}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-card__info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rate product-card__rate\",children:[_toConsumableArray(Array(STARS)).map(function(){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"svg\",{width:\"12\",height:\"11\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"use\",{href:\"#icon-full-star\"})})},Math.random());}),_toConsumableArray(Array(NULL_STARS)).map(function(){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"svg\",{width:\"12\",height:\"11\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"use\",{href:\"#icon-star\"})})},Math.random());}),/*#__PURE__*/_jsxs(\"p\",{className:\"visually-hidden\",children:[\"\\u0420\\u0435\\u0439\\u0442\\u0438\\u043D\\u0433 \",rating]}),/*#__PURE__*/_jsxs(\"p\",{className:\"rate__count\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"\\u0412\\u0441\\u0435\\u0433\\u043E \\u043E\\u0446\\u0435\\u043D\\u043E\\u043A:\"}),guitar.commentsCount||'0']})]}),/*#__PURE__*/_jsx(\"p\",{className:\"product-card__title\",children:name}),/*#__PURE__*/_jsxs(\"p\",{className:\"product-card__price\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"\\u0426\\u0435\\u043D\\u0430:\"}),pasrePrice(price),\" \\u20BD\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-card__buttons\",children:[/*#__PURE__*/_jsx(Link,{to:generatePath(AppRoute.Details,{id:String(id)}),className:\"button button--mini\",children:\"\\u041F\\u043E\\u0434\\u0440\\u043E\\u0431\\u043D\\u0435\\u0435\"}),!boughtGuitars.find(function(el){return el.id===id;})?/*#__PURE__*/_jsx(\"button\",{className:\"button button--red button--mini button--add-to-cart\",onClick:function onClick(){onBookingBtnClick();stopScroll();},children:\"\\u041A\\u0443\\u043F\\u0438\\u0442\\u044C\"}):/*#__PURE__*/_jsx(\"button\",{className:\"button button--red-border button--mini button--in-cart\",onClick:function onClick(){navigate(AppRoute.Basket);},children:\"\\u0412 \\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0435\"})]})]});}export default GuitarCard;","map":{"version":3,"sources":["/Users/mashkust/react-starter-pack-main/src/components/guitar-card.tsx"],"names":["React","useEffect","useState","generatePath","Link","useNavigate","AppRoute","STARS_MAX","useAppDispatch","useAppSelector","fetchCommentsAction","setIsBasket","setIsGuitar","pasrePrice","stopScroll","GuitarCard","guitar","name","price","previewImg","id","rating","boughtGuitars","DATA","mount","setMount","STARS","Math","ceil","NULL_STARS","dispatch","navigate","onBookingBtnClick","length","slice","substring","Array","map","random","commentsCount","Details","String","find","el","Basket"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { useState } from 'react';\nimport { generatePath, Link, useNavigate } from 'react-router-dom';\nimport { AppRoute, STARS_MAX } from '../const';\nimport { useAppDispatch, useAppSelector } from '../hooks/hooks';\nimport { fetchCommentsAction } from '../store/api-actions';\nimport { setIsBasket, setIsGuitar } from '../store/guitar-data';\nimport type { Guitar } from '../types/types';\nimport { pasrePrice, stopScroll } from '../utils';\n\ntype GuitarCardProps = {\n  guitar: Guitar;\n}\n\nfunction GuitarCard({ guitar }: GuitarCardProps): JSX.Element {\n  const { name, price, previewImg, id, rating } = guitar;\n  const boughtGuitars = useAppSelector(({ DATA }) => DATA.boughtGuitars);\n\n  const [mount, setMount] = useState(false);\n\n  const STARS = Math.ceil(rating);\n  const NULL_STARS = STARS_MAX - STARS;\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n\n  if (!mount) {\n    if (id) {\n      dispatch(fetchCommentsAction(id));\n    }\n  }\n\n  useEffect(() => {\n    setMount(true);\n  }, []);\n\n  const onBookingBtnClick = () => {\n    dispatch(setIsBasket(true));\n    dispatch(setIsGuitar(guitar));\n  };\n\n  return (\n    <div className=\"product-card\"><img src={`img/content/${previewImg.length && previewImg.slice(0).substring(4)}`} srcSet={`img/content/${previewImg.length && previewImg.slice(0).substring(4, previewImg.length - 4)}@2x.jpg 2x`} width=\"75\" height=\"190\" alt={name} />\n      <div className=\"product-card__info\">\n        <div className=\"rate product-card__rate\">\n          {\n            [...Array(STARS)].map(() => (\n              <React.Fragment key={Math.random()}>\n                <svg width=\"12\" height=\"11\" aria-hidden=\"true\">\n                  <use href=\"#icon-full-star\"></use>\n                </svg>\n              </React.Fragment>\n            ))\n          }\n          {\n            [...Array(NULL_STARS)].map(() => (\n              <React.Fragment key={Math.random()}>\n                <svg width=\"12\" height=\"11\" aria-hidden=\"true\">\n                  <use href=\"#icon-star\"></use>\n                </svg>\n              </React.Fragment>\n            ))\n          }\n          <p className=\"visually-hidden\">Рейтинг {rating}</p>\n          <p className=\"rate__count\"><span className=\"visually-hidden\">Всего оценок:</span>{guitar.commentsCount || '0'}</p>\n        </div>\n        <p className=\"product-card__title\">{name}</p>\n        <p className=\"product-card__price\"><span className=\"visually-hidden\">Цена:</span>{pasrePrice(price)} ₽\n        </p>\n      </div>\n      <div className=\"product-card__buttons\"><Link to={generatePath(AppRoute.Details, { id: String(id) })} className=\"button button--mini\" >Подробнее</Link>\n        {!boughtGuitars.find((el) => el.id === id) ?\n          <button className=\"button button--red button--mini button--add-to-cart\"\n            onClick={() => {\n              onBookingBtnClick();\n              stopScroll();\n            }}\n          >Купить\n          </button> :\n          <button className =\"button button--red-border button--mini button--in-cart\"\n            onClick={() => {\n              navigate(AppRoute.Basket);\n            }}\n          >В Корзине\n          </button>}\n      </div>\n    </div>\n  );\n}\n\nexport default GuitarCard;\n"]},"metadata":{},"sourceType":"module"}