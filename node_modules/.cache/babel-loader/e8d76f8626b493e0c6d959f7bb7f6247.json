{"ast":null,"code":"import _toConsumableArray from\"/Users/mashkust/react-starter-pack-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import React,{useEffect,useRef}from'react';import{Link,useParams}from'react-router-dom';import{AppRoute,STARS_MAX}from'../const';import{useAppDispatch,useAppSelector}from'../hooks/hooks';import{fetchCommentsAction,fetchGuitarAction}from'../store/api-actions';import LoadingScreen from'./loading-screen';import PageFooter from'./page-footer';import PageHeader from'./page-header';import GuitarTab from'./guitar-tab';import BasketAdiing from'./basket-adding';import Comments from'./guitar-tabs/comments';import ShowMore from'./show-more';import AddComments from'./add-comments';import SuccessComments from'./success-comments';import{pasrePrice,startScroll,stopScroll}from'../utils';import{setIsBasket,setIsCommentModalOpened,setIsSuccessBasket,setIsSuccessModalOpened}from'../store/guitar-data';import SuccessBasket from'./success-basket';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function GuitarPage(_ref){var tab=_ref.tab;var _useAppSelector=useAppSelector(function(_ref2){var DATA=_ref2.DATA;return DATA;}),guitar=_useAppSelector.guitar,comments=_useAppSelector.comments,isSuccessModalOpened=_useAppSelector.isSuccessModalOpened,isCommentModalOpened=_useAppSelector.isCommentModalOpened;var _useAppSelector2=useAppSelector(function(_ref3){var COMMENT=_ref3.COMMENT;return COMMENT;}),commentCardsCount=_useAppSelector2.commentCardsCount;var isBasketModalOpened=useAppSelector(function(_ref4){var DATA=_ref4.DATA;return DATA.isBasketModalOpened;});var isSuccessBasketModal=useAppSelector(function(_ref5){var DATA=_ref5.DATA;return DATA.isSuccessBasketModal;});useEffect(function(){window.scrollTo({top:0});},[]);var onBookingBtnClick=function onBookingBtnClick(){dispatch(setIsBasket(true));};var onCommentBtnClick=function onCommentBtnClick(){dispatch(setIsCommentModalOpened(true));};var onUpBtnClick=function onUpBtnClick(evt){evt.preventDefault();if(mainRef&&mainRef.current){mainRef.current.scrollIntoView({block:'start'});}};var dispatch=useAppDispatch();var params=useParams();useEffect(function(){var guitarid=Number(params.id);if(guitarid){dispatch(fetchGuitarAction(guitarid));dispatch(fetchCommentsAction(guitarid));}},[dispatch,params]);var mainRef=useRef(null);document.onkeydown=function(evt){evt=evt||window.event;var isEscape=false;if('key'in evt){isEscape=evt.key==='Escape'||evt.key==='Esc';}if(isEscape){dispatch(setIsCommentModalOpened(false));dispatch(setIsBasket(false));dispatch(setIsSuccessBasket(false));dispatch(setIsSuccessModalOpened(false));startScroll();}};if(guitar){var _ref6=guitar,name=_ref6.name,previewImg=_ref6.previewImg,price=_ref6.price,rating=_ref6.rating;var STARS=Math.ceil(rating);var NULL_STARS=STARS_MAX-STARS;return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(PageHeader,{}),/*#__PURE__*/_jsx(\"main\",{ref:mainRef,className:\"page-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-content__title title title--bigger\",children:name}),/*#__PURE__*/_jsxs(\"ul\",{className:\"breadcrumbs page-content__breadcrumbs\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumbs__item\",children:/*#__PURE__*/_jsx(Link,{className:\"link\",to:AppRoute.Page1,children:\"\\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumbs__item\",children:/*#__PURE__*/_jsx(Link,{className:\"link\",to:AppRoute.Page1,children:\"\\u041A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumbs__item\",children:/*#__PURE__*/_jsx(\"a\",{className:\"link\",children:name})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-container\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"product-container__img\",src:\"img/content/\".concat(previewImg.length&&previewImg.slice(0).substring(4)),srcSet:\"img/content/\".concat(previewImg.length&&previewImg.slice(0).substring(4,previewImg.length-4),\"@2x.jpg 2x\"),width:\"90\",height:\"235\",alt:name}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-container__info-wrapper\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"product-container__title title title--big title--uppercase\",children:name}),/*#__PURE__*/_jsxs(\"div\",{className:\"rate product-container__rating\",children:[_toConsumableArray(Array(STARS)).map(function(){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"svg\",{width:\"14\",height:\"14\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"use\",{href:\"#icon-full-star\"})})},Math.random());}),_toConsumableArray(Array(NULL_STARS)).map(function(){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"svg\",{width:\"14\",height:\"14\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"use\",{href:\"#icon-star\"})})},Math.random());}),/*#__PURE__*/_jsxs(\"p\",{className:\"visually-hidden\",children:[\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430 \",rating]}),/*#__PURE__*/_jsx(\"p\",{className:\"rate__count\",children:comments&&comments[0]?comments.length:'0'})]}),/*#__PURE__*/_jsx(GuitarTab,{tab:tab,guitar:guitar})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-container__price-wrapper\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"product-container__price-info product-container__price-info--title\",children:\"\\u0426\\u0435\\u043D\\u0430:\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"product-container__price-info product-container__price-info--value\",children:[pasrePrice(price),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--red button--big product-container__button\",onClick:function onClick(){onBookingBtnClick();stopScroll();},children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0432 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0443\"})]}),document.location.hash.includes('guitars')?isBasketModalOpened&&/*#__PURE__*/_jsx(BasketAdiing,{guitar:guitar}):'',document.location.hash.includes('guitars')?isSuccessBasketModal&&/*#__PURE__*/_jsx(SuccessBasket,{}):'']}),/*#__PURE__*/_jsxs(\"section\",{className:\"reviews\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"reviews__title title title--bigger\",children:\"\\u041E\\u0442\\u0437\\u044B\\u0432\\u044B\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--red-border button--big reviews__sumbit-button\",onClick:function onClick(){onCommentBtnClick();stopScroll();},children:\"\\u041E\\u0441\\u0442\\u0430\\u0432\\u0438\\u0442\\u044C \\u043E\\u0442\\u0437\\u044B\\u0432\"}),isCommentModalOpened&&/*#__PURE__*/_jsx(AddComments,{guitar:guitar}),isSuccessModalOpened&&/*#__PURE__*/_jsx(SuccessComments,{}),comments&&Array.from(comments).slice(0,commentCardsCount).map(function(comment){return/*#__PURE__*/_jsx(Comments,{someComment:comment},comment.id);}),comments&&comments.length>commentCardsCount?/*#__PURE__*/_jsx(ShowMore,{}):'',(comments===null||comments===void 0?void 0:comments.length)!==0?/*#__PURE__*/_jsx(\"button\",{style:{zIndex:10},className:\"button button--up button--red-border button--big reviews__up-button\",onClick:onUpBtnClick,children:\"\\u041D\\u0430\\u0432\\u0435\\u0440\\u0445\"}):'']})]})}),/*#__PURE__*/_jsx(PageFooter,{})]});}return/*#__PURE__*/_jsx(LoadingScreen,{});}export default GuitarPage;","map":{"version":3,"sources":["/Users/mashkust/react-starter-pack-main/src/components/guitar-page.tsx"],"names":["React","useEffect","useRef","Link","useParams","AppRoute","STARS_MAX","useAppDispatch","useAppSelector","fetchCommentsAction","fetchGuitarAction","LoadingScreen","PageFooter","PageHeader","GuitarTab","BasketAdiing","Comments","ShowMore","AddComments","SuccessComments","pasrePrice","startScroll","stopScroll","setIsBasket","setIsCommentModalOpened","setIsSuccessBasket","setIsSuccessModalOpened","SuccessBasket","GuitarPage","tab","DATA","guitar","comments","isSuccessModalOpened","isCommentModalOpened","COMMENT","commentCardsCount","isBasketModalOpened","isSuccessBasketModal","window","scrollTo","top","onBookingBtnClick","dispatch","onCommentBtnClick","onUpBtnClick","evt","preventDefault","mainRef","current","scrollIntoView","block","params","guitarid","Number","id","document","onkeydown","event","isEscape","key","name","previewImg","price","rating","STARS","Math","ceil","NULL_STARS","Page1","length","slice","substring","Array","map","random","location","hash","includes","from","comment","zIndex"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef} from 'react';\nimport type { MouseEvent } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { AppRoute, STARS_MAX } from '../const';\nimport { useAppDispatch, useAppSelector } from '../hooks/hooks';\nimport { fetchCommentsAction, fetchGuitarAction } from '../store/api-actions';\nimport { Guitar, Comment } from '../types/types';\nimport LoadingScreen from './loading-screen';\nimport PageFooter from './page-footer';\nimport PageHeader from './page-header';\nimport GuitarTab from './guitar-tab';\nimport BasketAdiing from './basket-adding';\nimport Comments from './guitar-tabs/comments';\nimport ShowMore from './show-more';\nimport AddComments from './add-comments';\nimport SuccessComments from './success-comments';\nimport { pasrePrice, startScroll, stopScroll } from '../utils';\nimport { setIsBasket, setIsCommentModalOpened, setIsSuccessBasket, setIsSuccessModalOpened } from '../store/guitar-data';\nimport SuccessBasket from './success-basket';\n\ntype GuitarPageProps = {\n  tab: boolean,\n}\n\nfunction GuitarPage({ tab }: GuitarPageProps): JSX.Element {\n  const { guitar, comments, isSuccessModalOpened, isCommentModalOpened } = useAppSelector(({ DATA }) => DATA);\n  const { commentCardsCount } = useAppSelector(({ COMMENT }) => COMMENT);\n  const isBasketModalOpened = useAppSelector(({ DATA }) => DATA.isBasketModalOpened);\n  const isSuccessBasketModal = useAppSelector(({ DATA }) => DATA.isSuccessBasketModal);\n\n  useEffect(() => {\n    window.scrollTo({ top: 0 });\n  }, []);\n\n  const onBookingBtnClick = () => {\n    dispatch(setIsBasket(true));\n  };\n\n  const onCommentBtnClick = () => {\n    dispatch(setIsCommentModalOpened(true));\n  };\n\n  const onUpBtnClick = (evt: MouseEvent<HTMLButtonElement>) => {\n    evt.preventDefault();\n    if (mainRef && mainRef.current) {\n      mainRef.current.scrollIntoView({ block: 'start' });\n    }\n  };\n\n  const dispatch = useAppDispatch();\n  const params = useParams();\n\n  useEffect(() => {\n    const guitarid = Number(params.id);\n\n    if (guitarid) {\n      dispatch(fetchGuitarAction(guitarid));\n      dispatch(fetchCommentsAction(guitarid));\n    }\n  }, [dispatch, params]);\n\n  const mainRef = useRef<HTMLElement | null>(null);\n\n  document.onkeydown = function (evt) {\n    evt = evt || window.event;\n    let isEscape = false;\n    if ('key' in evt) {\n      isEscape = (evt.key === 'Escape' || evt.key === 'Esc');\n    }\n    if (isEscape) {\n      dispatch(setIsCommentModalOpened(false));\n      dispatch(setIsBasket(false));\n      dispatch(setIsSuccessBasket(false));\n      dispatch(setIsSuccessModalOpened(false));\n      startScroll();\n    }\n  };\n\n  if (guitar) {\n    const { name, previewImg, price, rating } = guitar as Guitar;\n    const STARS = Math.ceil(rating);\n    const NULL_STARS = STARS_MAX - STARS;\n\n    return (\n      <React.Fragment>\n        <PageHeader />\n        <main ref={mainRef} className='page-content'>\n          <div className=\"container\">\n            <h1 className=\"page-content__title title title--bigger\">{name}</h1>\n            <ul className=\"breadcrumbs page-content__breadcrumbs\">\n              <li className=\"breadcrumbs__item\"><Link className=\"link\" to={AppRoute.Page1}>Главная</Link>\n              </li>\n              <li className=\"breadcrumbs__item\"><Link className=\"link\" to={AppRoute.Page1}>Каталог</Link>\n              </li>\n              <li className=\"breadcrumbs__item\"><a className=\"link\">{name}</a>\n              </li>\n            </ul>\n            <div className=\"product-container\"><img className=\"product-container__img\" src={`img/content/${previewImg.length && previewImg.slice(0).substring(4)}`} srcSet={`img/content/${previewImg.length && previewImg.slice(0).substring(4, previewImg.length - 4)}@2x.jpg 2x`} width=\"90\" height=\"235\" alt={name} />\n              <div className=\"product-container__info-wrapper\">\n                <h2 className=\"product-container__title title title--big title--uppercase\">{name}</h2>\n                <div className=\"rate product-container__rating\">\n                  {\n                    [...Array(STARS)].map(() => (\n                      <React.Fragment key={Math.random()}>\n                        <svg width=\"14\" height=\"14\" aria-hidden=\"true\">\n                          <use href=\"#icon-full-star\"></use>\n                        </svg>\n                      </React.Fragment>\n                    ))\n                  }\n                  {\n                    [...Array(NULL_STARS)].map(() => (\n                      <React.Fragment key={Math.random()}>\n                        <svg width=\"14\" height=\"14\" aria-hidden=\"true\">\n                          <use href=\"#icon-star\"></use>\n                        </svg>\n                      </React.Fragment>\n                    ))\n                  }\n                  <p className=\"visually-hidden\">Оценка {rating}</p>\n                  <p className=\"rate__count\">{comments && comments[0] ? comments.length : '0'}</p>\n                </div>\n                <GuitarTab tab={tab} guitar={guitar} />\n              </div>\n              <div className=\"product-container__price-wrapper\">\n                <p className=\"product-container__price-info product-container__price-info--title\">Цена:</p>\n                <p className=\"product-container__price-info product-container__price-info--value\">{pasrePrice(price)} ₽</p>\n                <button className=\"button button--red button--big product-container__button\"\n                  onClick={() => {\n                    onBookingBtnClick();\n                    stopScroll();\n                  }}\n                >\n                  Добавить в корзину\n                </button>\n              </div>\n              { document.location.hash.includes('guitars') ? isBasketModalOpened && <BasketAdiing guitar={guitar}/> : ''}\n              { document.location.hash.includes('guitars') ?  isSuccessBasketModal && <SuccessBasket /> : ''}\n            </div>\n            <section className=\"reviews\">\n              <h3 className=\"reviews__title title title--bigger\">Отзывы</h3>\n              <button className=\"button button--red-border button--big reviews__sumbit-button\"\n                onClick={() => {\n                  onCommentBtnClick();\n                  stopScroll();\n                }}\n              >Оставить отзыв\n              </button>\n              {isCommentModalOpened && <AddComments guitar={guitar} />}\n              {isSuccessModalOpened && <SuccessComments />}\n              {comments && Array.from(comments).slice(0, commentCardsCount).map((comment: Comment) => (\n                <Comments someComment={comment} key={comment.id} />))}\n              {comments && comments.length > commentCardsCount ? <ShowMore /> : ''}\n              {comments?.length !== 0 ? <button style={{ zIndex: 10 }} className=\"button button--up button--red-border button--big reviews__up-button\" onClick={onUpBtnClick}>Наверх</button> : ''}\n            </section>\n          </div>\n        </main>\n        <PageFooter />\n      </React.Fragment>\n    );\n  }\n  return <LoadingScreen />;\n}\n\nexport default GuitarPage;\n"]},"metadata":{},"sourceType":"module"}